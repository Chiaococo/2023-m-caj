apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: mono-backend-alert
spec:
  groups:
    - name: mono-backend
      rules:
        - alert: TargetDownAlert
          annotations:
            summary: '{{ $labels.app }} in {{ $labels.namespace }} namespace is down'
          expr: 'up{app="mono-backend",namespace="speaker01"} == 0'
          for: 5s
          labels:
            severity: Critical
        - alert: CpuUsageAlert
          annotations:
            summary: >-
              {{ $labels.app }} in {{ $labels.namespace }} cup is greater than
              1%
          expr: >-
            process_cpu_usage{app="mono-backend",namespace="speaker01"} >
            0.01
          for: 5s
          labels:
            severity: Warning